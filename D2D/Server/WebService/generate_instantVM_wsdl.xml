<?xml version="1.0" encoding="UTF-8"?>
<project name="CentralApps" default="build" basedir=".">

	<property name="dir.externalLib" value="..\..\..\ExternalLib" />
	<property name="dir.output" value="${basedir}" />
	<property name="dir.d2d" value="..\..\Server" />
	
	<property name="aspectj" value="${dir.externalLib}/aspectj/lib/aspectjrt.jar"/>
	<property name="quartz" value="${dir.externalLib}/quartz/quartz-all-1.6.5.jar"/>
	<property name="servlet" value="${dir.externalLib}/Tomcat/apache-tomcat/lib/servlet-api.jar"/>
	<property name="afjob" value="${dir.d2d}/VCM/AFJob/bin"/>
	<property name="afjobscript" value="${dir.d2d}/VCM/AFJobScript/bin"/>
	<property name="common" value="${dir.d2d}/Common/bin"/>
	<property name="contract" value="${dir.d2d}/WebServiceContract/bin"/>
	<property name="serviceimpl" value="${dir.d2d}/WebService/bin"/>
	<property name="vmwaremanager" value="${dir.d2d}/VMwareManager/bin"/>
	<property name="instantvm" value="${dir.d2d}/InstantVM/bin"/>

	<property name="instantvm.serviceimpl.class" value="com.ca.arcflash.webservice.InstantVMServiceImpl"/>	
	<property name="instantvm.service.name" value="{http://webservice.arcflash.ca.com}InstantVMServiceImpl"/>
	<property name="instantvm.port.name" value="{http://webservice.arcflash.ca.com}InstantVMServiceImplHttpSoap11Endpoint"/>

	<property name="wsgen.instantvm.classpath" value="${aspectj};${quartz};${servlet};${afjob};${afjobscript};${common};${contract};${serviceimpl};${vmwaremanager};${instantvm}"/>
	
	<target name="build" depends="generate_instantVM_wsdl,deploy_wsdl,clean"/>
	 
	<path id="wsgen.main.classpath">
		<pathelement location="${dir.externalLib}/jaxws/lib/jaxws-tools.jar"/>
		<pathelement location="${dir.externalLib}/jaxws/lib/jaxb-xjc.jar"/>
	</path>	
		
	<target name="generate_instantVM_wsdl">
		<delete dir="${dir.output}\wsdl"/>
		<mkdir dir="${dir.output}\wsdl"/>    
		<java classname="com.sun.tools.ws.WsGen">
         <arg value="-d"/>
		 <arg value="${dir.output}\wsdl"/>
		 <arg value="-r"/>
		 <arg value="${dir.output}\wsdl"/>
		 <arg value="-verbose"/>	
		 <arg value="-cp"/>
		 <arg value="${wsgen.instantvm.classpath}"/>
		 <arg value="${instantvm.serviceimpl.class}"/>
		 <arg value="-wsdl"/>
		 <arg value="-inlineSchemas"/>
		 <arg value="-servicename"/>
		 <arg value="${instantvm.service.name}"/>
		 <arg value="-portname"/>
		 <arg value="${instantvm.port.name}"/>
         <classpath refid="wsgen.main.classpath"/>
		</java>
	</target>
	
	<target name="deploy_wsdl">
		<copy file="${dir.output}\wsdl\InstantVMServiceImpl.wsdl"
			todir="..\WebServiceContract\src\com\ca\arcflash\webservice"/>
	</target>
	
	<target name="clean">
		<delete dir="${dir.output}\wsdl" deleteonexit="true"/>
	</target>
</project>